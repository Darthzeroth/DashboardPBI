<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Corporativo BI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

<div class="d-flex" id="wrapper">
    <div class="border-end" id="sidebar-wrapper" style="width: 250px;">
        <div class="sidebar-heading border-bottom bg-dark text-white p-3">
            <h5 class="m-0"><i class="bi bi-bar-chart-fill me-2"></i>Mi Portal BI</h5>
        </div>
        <div class="list-group list-group-flush">
            {% for item in menu %}
            <a href="/reporte/{{ loop.index0 }}" 
               class="list-group-item list-group-item-action {{ 'active' if loop.index0 == activo else '' }}">
                <i class="bi {{ item.icono }} me-2"></i> {{ item.nombre }}
            </a>
            {% endfor %}
        </div>
        
        <div class="mt-auto p-3 text-white-50 small text-center" style="position: absolute; bottom: 0; width: 250px;">
            Demo v1.0 <br> Usuario: DarthZeroth
        </div>
    </div>

    <div id="page-content-wrapper">
        <div id="report-container"></div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/powerbi-client/2.22.0/powerbi.min.js"></script>
<script>
    const reportContainer = document.getElementById('report-container');
    const models = window['powerbi-client'].models;

    const config = {
        type: 'report',
        tokenType: models.TokenType.Aad,
        accessToken: "{{ access_token }}",
        embedUrl: "{{ embed_url }}",
        id: "{{ report_id }}",
        permissions: models.Permissions.Read,
        settings: {
            filterPaneEnabled: false,
            navContentPaneEnabled: true,
            layoutType: models.LayoutType.Master
        }
    };

    let report = powerbi.embed(reportContainer, config);
</script>

</body>
</html>